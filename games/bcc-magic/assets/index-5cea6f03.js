var At=Object.defineProperty;var Dt=(t,r,e)=>r in t?At(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var b=(t,r,e)=>(Dt(t,typeof r!="symbol"?r+"":r,e),e);(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();var E=window.CustomEvent;(!E||typeof E=="object")&&(E=function(r,e){e=e||{};var n=document.createEvent("CustomEvent");return n.initCustomEvent(r,!!e.bubbles,!!e.cancelable,e.detail||null),n},E.prototype=window.Event.prototype);function rt(t,r){var e="on"+r.type.toLowerCase();return typeof t[e]=="function"&&t[e](r),t.dispatchEvent(r)}function Tt(t){for(;t&&t!==document.body;){var r=window.getComputedStyle(t),e=function(n,i){return!(r[n]===void 0||r[n]===i)};if(r.opacity<1||e("zIndex","auto")||e("transform","none")||e("mixBlendMode","normal")||e("filter","none")||e("perspective","none")||r.isolation==="isolate"||r.position==="fixed"||r.webkitOverflowScrolling==="touch")return!0;t=t.parentElement}return!1}function D(t){for(;t;){if(t.localName==="dialog")return t;t.parentElement?t=t.parentElement:t.parentNode?t=t.parentNode.host:t=null}return null}function nt(t){for(;t&&t.shadowRoot&&t.shadowRoot.activeElement;)t=t.shadowRoot.activeElement;t&&t.blur&&t!==document.body&&t.blur()}function Pt(t,r){for(var e=0;e<t.length;++e)if(t[e]===r)return!0;return!1}function j(t){return!t||!t.hasAttribute("method")?!1:t.getAttribute("method").toLowerCase()==="dialog"}function it(t){var r=["button","input","keygen","select","textarea"],e=r.map(function(a){return a+":not([disabled])"});e.push('[tabindex]:not([disabled]):not([tabindex=""])');var n=t.querySelector(e.join(", "));if(!n&&"attachShadow"in Element.prototype)for(var i=t.querySelectorAll("*"),o=0;o<i.length&&!(i[o].tagName&&i[o].shadowRoot&&(n=it(i[o].shadowRoot),n));o++);return n}function J(t){return t.isConnected||document.body.contains(t)}function ot(t){if(t.submitter)return t.submitter;var r=t.target;if(!(r instanceof HTMLFormElement))return null;var e=c.formSubmitter;if(!e){var n=t.target,i="getRootNode"in n&&n.getRootNode()||document;e=i.activeElement}return!e||e.form!==r?null:e}function Lt(t){if(!t.defaultPrevented){var r=t.target,e=c.imagemapUseValue,n=ot(t);e===null&&n&&(e=n.value);var i=D(r);if(i){var o=n&&n.getAttribute("formmethod")||r.getAttribute("method");o==="dialog"&&(t.preventDefault(),e!=null?i.close(e):i.close())}}}function at(t){if(this.dialog_=t,this.replacedStyleTop_=!1,this.openAsModal_=!1,t.hasAttribute("role")||t.setAttribute("role","dialog"),t.show=this.show.bind(this),t.showModal=this.showModal.bind(this),t.close=this.close.bind(this),t.addEventListener("submit",Lt,!1),"returnValue"in t||(t.returnValue=""),"MutationObserver"in window){var r=new MutationObserver(this.maybeHideModal.bind(this));r.observe(t,{attributes:!0,attributeFilter:["open"]})}else{var e=!1,n=function(){e?this.downgradeModal():this.maybeHideModal(),e=!1}.bind(this),i,o=function(a){if(a.target===t){var s="DOMNodeRemoved";e|=a.type.substr(0,s.length)===s,window.clearTimeout(i),i=window.setTimeout(n,0)}};["DOMAttrModified","DOMNodeRemoved","DOMNodeRemovedFromDocument"].forEach(function(a){t.addEventListener(a,o)})}Object.defineProperty(t,"open",{set:this.setOpen.bind(this),get:t.hasAttribute.bind(t,"open")}),this.backdrop_=document.createElement("div"),this.backdrop_.className="backdrop",this.backdrop_.addEventListener("mouseup",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("mousedown",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("click",this.backdropMouseEvent_.bind(this))}at.prototype={get dialog(){return this.dialog_},maybeHideModal:function(){this.dialog_.hasAttribute("open")&&J(this.dialog_)||this.downgradeModal()},downgradeModal:function(){this.openAsModal_&&(this.openAsModal_=!1,this.dialog_.style.zIndex="",this.replacedStyleTop_&&(this.dialog_.style.top="",this.replacedStyleTop_=!1),this.backdrop_.parentNode&&this.backdrop_.parentNode.removeChild(this.backdrop_),c.dm.removeDialog(this))},setOpen:function(t){t?this.dialog_.hasAttribute("open")||this.dialog_.setAttribute("open",""):(this.dialog_.removeAttribute("open"),this.maybeHideModal())},backdropMouseEvent_:function(t){if(this.dialog_.hasAttribute("tabindex"))this.dialog_.focus();else{var r=document.createElement("div");this.dialog_.insertBefore(r,this.dialog_.firstChild),r.tabIndex=-1,r.focus(),this.dialog_.removeChild(r)}var e=document.createEvent("MouseEvents");e.initMouseEvent(t.type,t.bubbles,t.cancelable,window,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget),this.dialog_.dispatchEvent(e),t.stopPropagation()},focus_:function(){var t=this.dialog_.querySelector("[autofocus]:not([disabled])");!t&&this.dialog_.tabIndex>=0&&(t=this.dialog_),t||(t=it(this.dialog_)),nt(document.activeElement),t&&t.focus()},updateZIndex:function(t,r){if(t<r)throw new Error("dialogZ should never be < backdropZ");this.dialog_.style.zIndex=t,this.backdrop_.style.zIndex=r},show:function(){this.dialog_.open||(this.setOpen(!0),this.focus_())},showModal:function(){if(this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'showModal' on dialog: The element is already open, and therefore cannot be opened modally.");if(!J(this.dialog_))throw new Error("Failed to execute 'showModal' on dialog: The element is not in a Document.");if(!c.dm.pushDialog(this))throw new Error("Failed to execute 'showModal' on dialog: There are too many open modal dialogs.");Tt(this.dialog_.parentElement)&&console.warn("A dialog is being shown inside a stacking context. This may cause it to be unusable. For more information, see this link: https://github.com/GoogleChrome/dialog-polyfill/#stacking-context"),this.setOpen(!0),this.openAsModal_=!0,c.needsCentering(this.dialog_)?(c.reposition(this.dialog_),this.replacedStyleTop_=!0):this.replacedStyleTop_=!1,this.dialog_.parentNode.insertBefore(this.backdrop_,this.dialog_.nextSibling),this.focus_()},close:function(t){if(!this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'close' on dialog: The element does not have an 'open' attribute, and therefore cannot be closed.");this.setOpen(!1),t!==void 0&&(this.dialog_.returnValue=t);var r=new E("close",{bubbles:!1,cancelable:!1});rt(this.dialog_,r)}};var c={};c.reposition=function(t){var r=document.body.scrollTop||document.documentElement.scrollTop,e=r+(window.innerHeight-t.offsetHeight)/2;t.style.top=Math.max(r,e)+"px"};c.isInlinePositionSetByStylesheet=function(t){for(var r=0;r<document.styleSheets.length;++r){var e=document.styleSheets[r],n=null;try{n=e.cssRules}catch{}if(n)for(var i=0;i<n.length;++i){var o=n[i],a=null;try{a=document.querySelectorAll(o.selectorText)}catch{}if(!(!a||!Pt(a,t))){var s=o.style.getPropertyValue("top"),l=o.style.getPropertyValue("bottom");if(s&&s!=="auto"||l&&l!=="auto")return!0}}}return!1};c.needsCentering=function(t){var r=window.getComputedStyle(t);return r.position!=="absolute"||t.style.top!=="auto"&&t.style.top!==""||t.style.bottom!=="auto"&&t.style.bottom!==""?!1:!c.isInlinePositionSetByStylesheet(t)};c.forceRegisterDialog=function(t){if((window.HTMLDialogElement||t.showModal)&&console.warn("This browser already supports <dialog>, the polyfill may not work correctly",t),t.localName!=="dialog")throw new Error("Failed to register dialog: The element is not a dialog.");new at(t)};c.registerDialog=function(t){t.showModal||c.forceRegisterDialog(t)};c.DialogManager=function(){this.pendingDialogStack=[];var t=this.checkDOM_.bind(this);this.overlay=document.createElement("div"),this.overlay.className="_dialog_overlay",this.overlay.addEventListener("click",function(r){this.forwardTab_=void 0,r.stopPropagation(),t([])}.bind(this)),this.handleKey_=this.handleKey_.bind(this),this.handleFocus_=this.handleFocus_.bind(this),this.zIndexLow_=1e5,this.zIndexHigh_=1e5+150,this.forwardTab_=void 0,"MutationObserver"in window&&(this.mo_=new MutationObserver(function(r){var e=[];r.forEach(function(n){for(var i=0,o;o=n.removedNodes[i];++i){if(o instanceof Element)o.localName==="dialog"&&e.push(o);else continue;e=e.concat(o.querySelectorAll("dialog"))}}),e.length&&t(e)}))};c.DialogManager.prototype.blockDocument=function(){document.documentElement.addEventListener("focus",this.handleFocus_,!0),document.addEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.observe(document,{childList:!0,subtree:!0})};c.DialogManager.prototype.unblockDocument=function(){document.documentElement.removeEventListener("focus",this.handleFocus_,!0),document.removeEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.disconnect()};c.DialogManager.prototype.updateStacking=function(){for(var t=this.zIndexHigh_,r=0,e;e=this.pendingDialogStack[r];++r)e.updateZIndex(--t,--t),r===0&&(this.overlay.style.zIndex=--t);var n=this.pendingDialogStack[0];if(n){var i=n.dialog.parentNode||document.body;i.appendChild(this.overlay)}else this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)};c.DialogManager.prototype.containedByTopDialog_=function(t){for(;t=D(t);){for(var r=0,e;e=this.pendingDialogStack[r];++r)if(e.dialog===t)return r===0;t=t.parentElement}return!1};c.DialogManager.prototype.handleFocus_=function(t){var r=t.composedPath?t.composedPath()[0]:t.target;if(!this.containedByTopDialog_(r)&&document.activeElement!==document.documentElement&&(t.preventDefault(),t.stopPropagation(),nt(r),this.forwardTab_!==void 0)){var e=this.pendingDialogStack[0],n=e.dialog,i=n.compareDocumentPosition(r);return i&Node.DOCUMENT_POSITION_PRECEDING&&(this.forwardTab_?e.focus_():r!==document.documentElement&&document.documentElement.focus()),!1}};c.DialogManager.prototype.handleKey_=function(t){if(this.forwardTab_=void 0,t.keyCode===27){t.preventDefault(),t.stopPropagation();var r=new E("cancel",{bubbles:!1,cancelable:!0}),e=this.pendingDialogStack[0];e&&rt(e.dialog,r)&&e.dialog.close()}else t.keyCode===9&&(this.forwardTab_=!t.shiftKey)};c.DialogManager.prototype.checkDOM_=function(t){var r=this.pendingDialogStack.slice();r.forEach(function(e){t.indexOf(e.dialog)!==-1?e.downgradeModal():e.maybeHideModal()})};c.DialogManager.prototype.pushDialog=function(t){var r=(this.zIndexHigh_-this.zIndexLow_)/2-1;return this.pendingDialogStack.length>=r?!1:(this.pendingDialogStack.unshift(t)===1&&this.blockDocument(),this.updateStacking(),!0)};c.DialogManager.prototype.removeDialog=function(t){var r=this.pendingDialogStack.indexOf(t);r!==-1&&(this.pendingDialogStack.splice(r,1),this.pendingDialogStack.length===0&&this.unblockDocument(),this.updateStacking())};c.dm=new c.DialogManager;c.formSubmitter=null;c.imagemapUseValue=null;if(window.HTMLDialogElement===void 0){var W=document.createElement("form");if(W.setAttribute("method","dialog"),W.method!=="dialog"){var S=Object.getOwnPropertyDescriptor(HTMLFormElement.prototype,"method");if(S){var Ct=S.get;S.get=function(){return j(this)?"dialog":Ct.call(this)};var Bt=S.set;S.set=function(t){return typeof t=="string"&&t.toLowerCase()==="dialog"?this.setAttribute("method",t):Bt.call(this,t)},Object.defineProperty(HTMLFormElement.prototype,"method",S)}}document.addEventListener("click",function(t){if(c.formSubmitter=null,c.imagemapUseValue=null,!t.defaultPrevented){var r=t.target;if("composedPath"in t){var e=t.composedPath();r=e.shift()||r}if(!(!r||!j(r.form))){var n=r.type==="submit"&&["button","input"].indexOf(r.localName)>-1;if(!n){if(!(r.localName==="input"&&r.type==="image"))return;c.imagemapUseValue=t.offsetX+","+t.offsetY}var i=D(r);i&&(c.formSubmitter=r)}}},!1),document.addEventListener("submit",function(t){var r=t.target,e=D(r);if(!e){var n=ot(t),i=n&&n.getAttribute("formmethod")||r.getAttribute("method");i==="dialog"&&t.preventDefault()}});var jt=HTMLFormElement.prototype.submit,Ft=function(){if(!j(this))return jt.call(this);var t=D(this);t&&t.close()};HTMLFormElement.prototype.submit=Ft}function F(t){return new Promise(r=>{const e=document.querySelector("dialog");if(!e)return;c.registerDialog(e);const n=e.querySelector(".dialog__content"),i=e.querySelector(".dialog__button");!n||!i||(n.innerHTML=t,i.addEventListener("click",()=>{r()}),e.showModal())})}var z=function(t,r){return z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])},z(t,r)};function g(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");z(t,r);function e(){this.constructor=t}t.prototype=r===null?Object.create(r):(e.prototype=r.prototype,new e)}function Nt(t,r,e,n){function i(o){return o instanceof e?o:new e(function(a){a(o)})}return new(e||(e=Promise))(function(o,a){function s(d){try{u(n.next(d))}catch(m){a(m)}}function l(d){try{u(n.throw(d))}catch(m){a(m)}}function u(d){d.done?o(d.value):i(d.value).then(s,l)}u((n=n.apply(t,r||[])).next())})}function st(t,r){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return e.label++,{value:u[1],done:!1};case 5:e.label++,i=u[1],u=[0];continue;case 7:u=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){e=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){e.label=u[1];break}if(u[0]===6&&e.label<o[1]){e.label=o[1],o=u;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(u);break}o[2]&&e.ops.pop(),e.trys.pop();continue}u=r.call(t,e)}catch(d){u=[6,d],i=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function k(t){var r=typeof Symbol=="function"&&Symbol.iterator,e=r&&t[r],n=0;if(e)return e.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function O(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,o=[],a;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(s){a={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return o}function M(t,r,e){if(e||arguments.length===2)for(var n=0,i=r.length,o;n<i;n++)(o||!(n in r))&&(o||(o=Array.prototype.slice.call(r,0,n)),o[n]=r[n]);return t.concat(o||Array.prototype.slice.call(r))}function I(t){return this instanceof I?(this.v=t,this):new I(t)}function Ut(t,r,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(t,r||[]),i,o=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(f){n[f]&&(i[f]=function(y){return new Promise(function(A,p){o.push([f,y,A,p])>1||s(f,y)})})}function s(f,y){try{l(n[f](y))}catch(A){m(o[0][3],A)}}function l(f){f.value instanceof I?Promise.resolve(f.value.v).then(u,d):m(o[0][2],f)}function u(f){s("next",f)}function d(f){s("throw",f)}function m(f,y){f(y),o.shift(),o.length&&s(o[0][0],o[0][1])}}function zt(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t[Symbol.asyncIterator],e;return r?r.call(t):(t=typeof k=="function"?k(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(o){e[o]=t[o]&&function(a){return new Promise(function(s,l){a=t[o](a),i(s,l,a.done,a.value)})}}function i(o,a,s,l){Promise.resolve(l).then(function(u){o({value:u,done:s})},a)}}function h(t){return typeof t=="function"}function ut(t){var r=function(n){Error.call(n),n.stack=new Error().stack},e=t(r);return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var N=ut(function(t){return function(e){t(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(n,i){return i+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e}});function C(t,r){if(t){var e=t.indexOf(r);0<=e&&t.splice(e,1)}}var T=function(){function t(r){this.initialTeardown=r,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var r,e,n,i,o;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var s=k(a),l=s.next();!l.done;l=s.next()){var u=l.value;u.remove(this)}}catch(p){r={error:p}}finally{try{l&&!l.done&&(e=s.return)&&e.call(s)}finally{if(r)throw r.error}}else a.remove(this);var d=this.initialTeardown;if(h(d))try{d()}catch(p){o=p instanceof N?p.errors:[p]}var m=this._finalizers;if(m){this._finalizers=null;try{for(var f=k(m),y=f.next();!y.done;y=f.next()){var A=y.value;try{X(A)}catch(p){o=o??[],p instanceof N?o=M(M([],O(o)),O(p.errors)):o.push(p)}}}catch(p){n={error:p}}finally{try{y&&!y.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}}if(o)throw new N(o)}},t.prototype.add=function(r){var e;if(r&&r!==this)if(this.closed)X(r);else{if(r instanceof t){if(r.closed||r._hasParent(this))return;r._addParent(this)}(this._finalizers=(e=this._finalizers)!==null&&e!==void 0?e:[]).push(r)}},t.prototype._hasParent=function(r){var e=this._parentage;return e===r||Array.isArray(e)&&e.includes(r)},t.prototype._addParent=function(r){var e=this._parentage;this._parentage=Array.isArray(e)?(e.push(r),e):e?[e,r]:r},t.prototype._removeParent=function(r){var e=this._parentage;e===r?this._parentage=null:Array.isArray(e)&&C(e,r)},t.prototype.remove=function(r){var e=this._finalizers;e&&C(e,r),r instanceof t&&r._removeParent(this)},t.EMPTY=function(){var r=new t;return r.closed=!0,r}(),t}(),lt=T.EMPTY;function ct(t){return t instanceof T||t&&"closed"in t&&h(t.remove)&&h(t.add)&&h(t.unsubscribe)}function X(t){h(t)?t():t.unsubscribe()}var ft={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},H={setTimeout:function(t,r){for(var e=[],n=2;n<arguments.length;n++)e[n-2]=arguments[n];var i=H.delegate;return i!=null&&i.setTimeout?i.setTimeout.apply(i,M([t,r],O(e))):setTimeout.apply(void 0,M([t,r],O(e)))},clearTimeout:function(t){var r=H.delegate;return((r==null?void 0:r.clearTimeout)||clearTimeout)(t)},delegate:void 0};function dt(t){H.setTimeout(function(){throw t})}function Z(){}function L(t){t()}var V=function(t){g(r,t);function r(e){var n=t.call(this)||this;return n.isStopped=!1,e?(n.destination=e,ct(e)&&e.add(n)):n.destination=qt,n}return r.create=function(e,n,i){return new R(e,n,i)},r.prototype.next=function(e){this.isStopped||this._next(e)},r.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},r.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},r.prototype._next=function(e){this.destination.next(e)},r.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},r.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},r}(T),Ht=Function.prototype.bind;function U(t,r){return Ht.call(t,r)}var Rt=function(){function t(r){this.partialObserver=r}return t.prototype.next=function(r){var e=this.partialObserver;if(e.next)try{e.next(r)}catch(n){P(n)}},t.prototype.error=function(r){var e=this.partialObserver;if(e.error)try{e.error(r)}catch(n){P(n)}else P(r)},t.prototype.complete=function(){var r=this.partialObserver;if(r.complete)try{r.complete()}catch(e){P(e)}},t}(),R=function(t){g(r,t);function r(e,n,i){var o=t.call(this)||this,a;if(h(e)||!e)a={next:e??void 0,error:n??void 0,complete:i??void 0};else{var s;o&&ft.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=function(){return o.unsubscribe()},a={next:e.next&&U(e.next,s),error:e.error&&U(e.error,s),complete:e.complete&&U(e.complete,s)}):a=e}return o.destination=new Rt(a),o}return r}(V);function P(t){dt(t)}function Vt(t){throw t}var qt={closed:!0,next:Z,error:Vt,complete:Z},q=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Gt(t){return t}function Kt(t){return t.length===0?Gt:t.length===1?t[0]:function(e){return t.reduce(function(n,i){return i(n)},e)}}var v=function(){function t(r){r&&(this._subscribe=r)}return t.prototype.lift=function(r){var e=new t;return e.source=this,e.operator=r,e},t.prototype.subscribe=function(r,e,n){var i=this,o=Jt(r)?r:new R(r,e,n);return L(function(){var a=i,s=a.operator,l=a.source;o.add(s?s.call(o,l):l?i._subscribe(o):i._trySubscribe(o))}),o},t.prototype._trySubscribe=function(r){try{return this._subscribe(r)}catch(e){r.error(e)}},t.prototype.forEach=function(r,e){var n=this;return e=$(e),new e(function(i,o){var a=new R({next:function(s){try{r(s)}catch(l){o(l),a.unsubscribe()}},error:o,complete:i});n.subscribe(a)})},t.prototype._subscribe=function(r){var e;return(e=this.source)===null||e===void 0?void 0:e.subscribe(r)},t.prototype[q]=function(){return this},t.prototype.pipe=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return Kt(r)(this)},t.prototype.toPromise=function(r){var e=this;return r=$(r),new r(function(n,i){var o;e.subscribe(function(a){return o=a},function(a){return i(a)},function(){return n(o)})})},t.create=function(r){return new t(r)},t}();function $(t){var r;return(r=t??ft.Promise)!==null&&r!==void 0?r:Promise}function Yt(t){return t&&h(t.next)&&h(t.error)&&h(t.complete)}function Jt(t){return t&&t instanceof V||Yt(t)&&ct(t)}function Wt(t){return h(t==null?void 0:t.lift)}function G(t){return function(r){if(Wt(r))return r.lift(function(e){try{return t(e,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function ht(t,r,e,n,i){return new Xt(t,r,e,n,i)}var Xt=function(t){g(r,t);function r(e,n,i,o,a,s){var l=t.call(this,e)||this;return l.onFinalize=a,l.shouldUnsubscribe=s,l._next=n?function(u){try{n(u)}catch(d){e.error(d)}}:t.prototype._next,l._error=o?function(u){try{o(u)}catch(d){e.error(d)}finally{this.unsubscribe()}}:t.prototype._error,l._complete=i?function(){try{i()}catch(u){e.error(u)}finally{this.unsubscribe()}}:t.prototype._complete,l}return r.prototype.unsubscribe=function(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;t.prototype.unsubscribe.call(this),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}},r}(V),Zt=ut(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),pt=function(t){g(r,t);function r(){var e=t.call(this)||this;return e.closed=!1,e.currentObservers=null,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return r.prototype.lift=function(e){var n=new Q(this,this);return n.operator=e,n},r.prototype._throwIfClosed=function(){if(this.closed)throw new Zt},r.prototype.next=function(e){var n=this;L(function(){var i,o;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var a=k(n.currentObservers),s=a.next();!s.done;s=a.next()){var l=s.value;l.next(e)}}catch(u){i={error:u}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}}})},r.prototype.error=function(e){var n=this;L(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=e;for(var i=n.observers;i.length;)i.shift().error(e)}})},r.prototype.complete=function(){var e=this;L(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var n=e.observers;n.length;)n.shift().complete()}})},r.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(r.prototype,"observed",{get:function(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0},enumerable:!1,configurable:!0}),r.prototype._trySubscribe=function(e){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,e)},r.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},r.prototype._innerSubscribe=function(e){var n=this,i=this,o=i.hasError,a=i.isStopped,s=i.observers;return o||a?lt:(this.currentObservers=null,s.push(e),new T(function(){n.currentObservers=null,C(s,e)}))},r.prototype._checkFinalizedStatuses=function(e){var n=this,i=n.hasError,o=n.thrownError,a=n.isStopped;i?e.error(o):a&&e.complete()},r.prototype.asObservable=function(){var e=new v;return e.source=this,e},r.create=function(e,n){return new Q(e,n)},r}(v),Q=function(t){g(r,t);function r(e,n){var i=t.call(this)||this;return i.destination=e,i.source=n,i}return r.prototype.next=function(e){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.next)===null||i===void 0||i.call(n,e)},r.prototype.error=function(e){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.error)===null||i===void 0||i.call(n,e)},r.prototype.complete=function(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)},r.prototype._subscribe=function(e){var n,i;return(i=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&i!==void 0?i:lt},r}(pt),$t=function(t){g(r,t);function r(e){var n=t.call(this)||this;return n._value=e,n}return Object.defineProperty(r.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),r.prototype._subscribe=function(e){var n=t.prototype._subscribe.call(this,e);return!n.closed&&e.next(this._value),n},r.prototype.getValue=function(){var e=this,n=e.hasError,i=e.thrownError,o=e._value;if(n)throw i;return this._throwIfClosed(),o},r.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},r}(pt),vt={now:function(){return(vt.delegate||Date).now()},delegate:void 0},Qt=function(t){g(r,t);function r(e,n){return t.call(this)||this}return r.prototype.schedule=function(e,n){return this},r}(T),B={setInterval:function(t,r){for(var e=[],n=2;n<arguments.length;n++)e[n-2]=arguments[n];var i=B.delegate;return i!=null&&i.setInterval?i.setInterval.apply(i,M([t,r],O(e))):setInterval.apply(void 0,M([t,r],O(e)))},clearInterval:function(t){var r=B.delegate;return((r==null?void 0:r.clearInterval)||clearInterval)(t)},delegate:void 0},te=function(t){g(r,t);function r(e,n){var i=t.call(this,e,n)||this;return i.scheduler=e,i.work=n,i.pending=!1,i}return r.prototype.schedule=function(e,n){var i;if(n===void 0&&(n=0),this.closed)return this;this.state=e;var o=this.id,a=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(a,o,n)),this.pending=!0,this.delay=n,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(a,this.id,n),this},r.prototype.requestAsyncId=function(e,n,i){return i===void 0&&(i=0),B.setInterval(e.flush.bind(e,this),i)},r.prototype.recycleAsyncId=function(e,n,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return n;n!=null&&B.clearInterval(n)},r.prototype.execute=function(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(e,n);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},r.prototype._execute=function(e,n){var i=!1,o;try{this.work(e)}catch(a){i=!0,o=a||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),o},r.prototype.unsubscribe=function(){if(!this.closed){var e=this,n=e.id,i=e.scheduler,o=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,C(o,this),n!=null&&(this.id=this.recycleAsyncId(i,n,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},r}(Qt),tt=function(){function t(r,e){e===void 0&&(e=t.now),this.schedulerActionCtor=r,this.now=e}return t.prototype.schedule=function(r,e,n){return e===void 0&&(e=0),new this.schedulerActionCtor(this,r).schedule(n,e)},t.now=vt.now,t}(),ee=function(t){g(r,t);function r(e,n){n===void 0&&(n=tt.now);var i=t.call(this,e,n)||this;return i.actions=[],i._active=!1,i}return r.prototype.flush=function(e){var n=this.actions;if(this._active){n.push(e);return}var i;this._active=!0;do if(i=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,i){for(;e=n.shift();)e.unsubscribe();throw i}},r}(tt),re=new ee(te),ne=re,ie=new v(function(t){return t.complete()});function oe(t){return t&&h(t.schedule)}var yt=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function bt(t){return h(t==null?void 0:t.then)}function mt(t){return h(t[q])}function gt(t){return Symbol.asyncIterator&&h(t==null?void 0:t[Symbol.asyncIterator])}function wt(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function ae(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var St=ae();function _t(t){return h(t==null?void 0:t[St])}function Et(t){return Ut(this,arguments,function(){var e,n,i,o;return st(this,function(a){switch(a.label){case 0:e=t.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,I(e.read())];case 3:return n=a.sent(),i=n.value,o=n.done,o?[4,I(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,I(i)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return e.releaseLock(),[7];case 10:return[2]}})})}function xt(t){return h(t==null?void 0:t.getReader)}function K(t){if(t instanceof v)return t;if(t!=null){if(mt(t))return se(t);if(yt(t))return ue(t);if(bt(t))return le(t);if(gt(t))return It(t);if(_t(t))return ce(t);if(xt(t))return fe(t)}throw wt(t)}function se(t){return new v(function(r){var e=t[q]();if(h(e.subscribe))return e.subscribe(r);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function ue(t){return new v(function(r){for(var e=0;e<t.length&&!r.closed;e++)r.next(t[e]);r.complete()})}function le(t){return new v(function(r){t.then(function(e){r.closed||(r.next(e),r.complete())},function(e){return r.error(e)}).then(null,dt)})}function ce(t){return new v(function(r){var e,n;try{for(var i=k(t),o=i.next();!o.done;o=i.next()){var a=o.value;if(r.next(a),r.closed)return}}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}r.complete()})}function It(t){return new v(function(r){de(t,r).catch(function(e){return r.error(e)})})}function fe(t){return It(Et(t))}function de(t,r){var e,n,i,o;return Nt(this,void 0,void 0,function(){var a,s;return st(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),e=zt(t),l.label=1;case 1:return[4,e.next()];case 2:if(n=l.sent(),!!n.done)return[3,4];if(a=n.value,r.next(a),r.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=l.sent(),i={error:s},[3,11];case 6:return l.trys.push([6,,9,10]),n&&!n.done&&(o=e.return)?[4,o.call(e)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return r.complete(),[2]}})})}function w(t,r,e,n,i){n===void 0&&(n=0),i===void 0&&(i=!1);var o=r.schedule(function(){e(),i?t.add(this.schedule(null,n)):this.unsubscribe()},n);if(t.add(o),!i)return o}function kt(t,r){return r===void 0&&(r=0),G(function(e,n){e.subscribe(ht(n,function(i){return w(n,t,function(){return n.next(i)},r)},function(){return w(n,t,function(){return n.complete()},r)},function(i){return w(n,t,function(){return n.error(i)},r)}))})}function Ot(t,r){return r===void 0&&(r=0),G(function(e,n){n.add(t.schedule(function(){return e.subscribe(n)},r))})}function he(t,r){return K(t).pipe(Ot(r),kt(r))}function pe(t,r){return K(t).pipe(Ot(r),kt(r))}function ve(t,r){return new v(function(e){var n=0;return r.schedule(function(){n===t.length?e.complete():(e.next(t[n++]),e.closed||this.schedule())})})}function ye(t,r){return new v(function(e){var n;return w(e,r,function(){n=t[St](),w(e,r,function(){var i,o,a;try{i=n.next(),o=i.value,a=i.done}catch(s){e.error(s);return}a?e.complete():e.next(o)},0,!0)}),function(){return h(n==null?void 0:n.return)&&n.return()}})}function Mt(t,r){if(!t)throw new Error("Iterable cannot be null");return new v(function(e){w(e,r,function(){var n=t[Symbol.asyncIterator]();w(e,r,function(){n.next().then(function(i){i.done?e.complete():e.next(i.value)})},0,!0)})})}function be(t,r){return Mt(Et(t),r)}function me(t,r){if(t!=null){if(mt(t))return he(t,r);if(yt(t))return ve(t,r);if(bt(t))return pe(t,r);if(gt(t))return Mt(t,r);if(_t(t))return ye(t,r);if(xt(t))return be(t,r)}throw wt(t)}function ge(t,r){return r?me(t,r):K(t)}function we(t){return t instanceof Date&&!isNaN(t)}function Se(t,r,e){t===void 0&&(t=0),e===void 0&&(e=ne);var n=-1;return r!=null&&(oe(r)?e=r:n=r),new v(function(i){var o=we(t)?+t-e.now():t;o<0&&(o=0);var a=0;return e.schedule(function(){i.closed||(i.next(a++),0<=n?this.schedule(void 0,n):i.complete())},o)})}function et(t){return t<=0?function(){return ie}:G(function(r,e){var n=0;r.subscribe(ht(e,function(i){++n<=t&&(e.next(i),t<=n&&e.complete())}))})}const x=class{constructor(r=3){b(this,"colors");b(this,"gridSubject");b(this,"grid");this.dimensions=r,this.colors=[x.RED,x.WHITE,x.BLUE],this.gridSubject=new $t(new Array),this.grid=this.gridSubject.asObservable(),this.gridSubject.next(this.initialize(r))}initialize(r){this.dimensions=r;const e=new Array(this.dimensions);for(let n=0;n<this.dimensions;++n)e[n]=new Array(this.dimensions).fill(x.WHITE);return e}setGrid(r){this.dimensions=r[0].length,this.gridSubject.next(this.cloneGrid(r))}shuffle(r){const e=this.cloneGrid(r);for(let n=0;n<e.length;++n)for(let i=0;i<e[n].length;++i)e[n][i]=this.colors[Math.floor(Math.random()*this.colors.length)];return e}restart(r){let e=this.gridSubject.value;r!==void 0&&r!==this.dimensions&&(e=this.initialize(r)),this.gridSubject.next(this.shuffle(e))}tap(r,e){this.advanceOne(r,e),this.advanceOne(r-1,e),this.advanceOne(r,e-1),this.advanceOne(r+1,e),this.advanceOne(r,e+1)}isSolved(){const r=this.gridSubject.value,e=r[0][0];for(let n=0;n<r.length;++n)for(let i=0;i<r[n].length;++i)if(r[n][i]!==e)return!1;return!0}gridDebugString(){return JSON.stringify(this.gridSubject.value)}cloneGrid(r){return JSON.parse(JSON.stringify(r))}advanceColor(r){const n=(Math.max(0,this.colors.indexOf(r))+1)%this.colors.length;return this.colors[n]}advanceOne(r,e){if(r<0||r>=this.dimensions||e<0||e>=this.dimensions)return;const n=this.gridSubject.value;n[r][e]=this.advanceColor(n[r][e]),this.gridSubject.next(n)}};let _=x;b(_,"RED","red"),b(_,"WHITE","white"),b(_,"BLUE","blue");class Y{constructor(r,e){b(this,"boardView");b(this,"newGameButton");b(this,"gridSizeSelect");b(this,"buttons");b(this,"gameBoard");var o,a;this.storage=e,this.boardView=r.querySelector("#board"),this.newGameButton=r.querySelector("#toolbar__newgame"),this.gridSizeSelect=r.querySelector("#toolbar__gridsize"),this.buttons=new Array;const n=JSON.parse(e.getItem("grid")??"null");this.gameBoard=new _,this.setUpButtons();let i=!0;this.gameBoard.grid.subscribe(s=>{this.onGridUpdate(s,i),i=!1}),n?this.gameBoard.setGrid(n):this.gameBoard.restart(),(o=this.gridSizeSelect)==null||o.addEventListener("change",()=>{this.resizeGameBoard()}),(a=this.newGameButton)==null||a.addEventListener("click",()=>{Promise.resolve().then(()=>{this.gameBoard.restart()}).then(()=>F("Better luck this time!"))})}onGridUpdate(r,e){this.storage.setItem("grid",JSON.stringify(r)),this.setUpButtons(),this.updateBoard(r),!e&&this.gameBoard.isSolved()&&ge(F("You did a thing!<br>gameboard state = "+this.gameBoard.gridDebugString()+"<br>grid state = "+JSON.stringify(r))).pipe(et(1)).subscribe(()=>{this.gameBoard.restart(this.gameBoard.dimensions),Se(0).pipe(et(1)).subscribe(()=>{F("Now do it again!").finally()})})}static initialize(r,e){return new Y(r,e)}resizeGameBoard(){this.gameBoard.restart(this.gridSizeSelect?parseInt(this.gridSizeSelect.value):5)}updateBoard(r){var e;for(let n=0;n<this.buttons.length&&!(n>=this.gameBoard.dimensions**2);++n){const i=Math.floor(n/this.gameBoard.dimensions),o=n%this.gameBoard.dimensions,a=this.buttons[n];a.style.backgroundColor=((e=r==null?void 0:r[i])==null?void 0:e[o])??"white"}}setUpButtons(){var e,n;const r=this.boardView;for(r.style.gridTemplateColumns=" 1fr".repeat(this.gameBoard.dimensions),r.style.gridTemplateRows=" 62px".repeat(this.gameBoard.dimensions),this.buttons.length=0;((e=this.boardView)==null?void 0:e.lastChild)!=null;)this.boardView.removeChild(this.boardView.lastChild);for(let i=0;i<this.gameBoard.dimensions**2;++i){const o=document.createElement("button");o.className="gameboard__button",o.innerHTML="&nbsp;",this.buttons.push(o),(n=this.boardView)==null||n.appendChild(o);const a=Math.floor(i/this.gameBoard.dimensions),s=i%this.gameBoard.dimensions;o.addEventListener("click",l=>{l.preventDefault(),this.gameBoard.tap(a,s)})}}}document.addEventListener("DOMContentLoaded",()=>{Y.initialize(document,window.localStorage)});
